#!/bin/sh
#
# Pre-commit hook to update README.md with current tool status
# This hook will run before each commit to ensure the README is up to date

# Skip if this is already a hook-generated commit
if git log -1 --pretty=format:"%s" | grep -q "\[skip hook\]"; then
    echo "ğŸ”„ Skipping README update (hook-generated commit)"
    exit 0
fi

echo "ğŸ”„ Updating README.md with current tool status..."

# Run the update script
npm run status --silent 2>/dev/null || echo "âš ï¸ Status update failed, continuing..."

# Check if README.md was modified
if git diff --cached --name-only | grep -q "README.md"; then
    echo "ğŸ“ README.md already staged for commit"
else
    # Check if README.md was modified by the script
    if git diff --name-only | grep -q "README.md"; then
        echo "ğŸ“ Adding updated README.md to commit"
        git add README.md
    fi
fi

echo "âœ… Pre-commit checks complete"
exit 0
